# MCP Agent Quick Reference

**Fast lookup** for diagnosing MCP failures when generated by LLM agents.

## Error Classification

| Error Type | Root Cause | Key Signal | Solution |
|-----------|-----------|-----------|----------|
| **Exit 127** | Not shell command | `command not found` | Explain tool interface vs shell |
| **EPIPE** | Server crashed | `Broken pipe` | Check config, restart server |
| **Timeout** | Server slow | `Did not respond` | Increase timeout, check resources |
| **ENOENT** | Config missing | `No such process` | Install server, verify `.mcp.json` |
| **Runtime Fail** | Tool error | Status `FAILURE` | Check params, verify tool exists |

## One-Line Diagnoses

```
127:     "MCP tools aren't shell commands; use the tool interface instead"
EPIPE:   "MCP server crashed; check .mcp.json config and restart"
Timeout: "Server too slow; increase startup_timeout_seconds in vtcode.toml"
ENOENT:  "Server not configured; verify .mcp.json and install the package"
FAILURE: "Tool ran but failed; check parameters and server version"
```

## Agent Response Template

```markdown
**Issue:** [Describe what failed]

MCP tools require:
- Running server process
- Proper .mcp.json configuration
- Tool interface invocation (not shell)

**To fix:**

1. [Check/Verify step]
   [command example]

2. [Install/Configure step]
   [command example]

3. [Test/Verify step]
   [command example]

See: docs/mcp/MCP_DIAGNOSTIC_GUIDE.md for detailed diagnostics.
```

## Command Lookup

```bash
# Check what's happening
vtcode doctor                          # Full system check
ps aux | grep mcp-server-              # Running processes
echo $PATH                              # Check PATH

# Install servers
pip install mcp-server-time
pip install mcp-server-fetch

# Test server
uvx mcp-server-time --help
uvx mcp-server-fetch --help

# View configuration
cat .mcp.json
cat vtcode.toml | grep -A 10 "^\\[mcp\\]"
```

## Common Fixes Cheat Sheet

### Time MCP Not Found (127)
```
The MCP tool system is separate from shell commands.
To use time MCP, install: pip install mcp-server-time
Check .mcp.json has "time" provider configured.
```

### Time MCP Broken Pipe
```
1. Verify server installed: uvx mcp-server-time --help
2. Check .mcp.json has "command": "uvx", "args": ["mcp-server-time"]
3. Enable MCP in vtcode.toml: [mcp] enabled = true
4. Test: vtcode doctor
```

### Time MCP Timeout
```
1. Increase timeout in vtcode.toml: startup_timeout_seconds = 30
2. Check free memory: free -h
3. Run manually to test: uvx mcp-server-time
4. Enable debug: [mcp] log_level = "debug"
```

## When to Use Each Document

- **Quick lookup of error â†’ solution:** Use this file (MCP_AGENT_QUICK_REFERENCE.md)
- **Detailed diagnostics & workflow:** See MCP_DIAGNOSTIC_GUIDE.md
- **Implementation & architecture:** See MCP_COMPLETE_IMPLEMENTATION_STATUS.md
- **Timeout configuration:** See MCP_INITIALIZATION_TIMEOUT.md
- **Performance tuning:** See MCP_PERFORMANCE_BENCHMARKS.md
